<div class="ngx-smart-table-container">
  <nz-table
    #basicTable
    [nzData]="data"
    [nzLoading]="loading"
    [nzPageSize]="rows"
    [nzShowPagination]="paginator"
    [nzPageSizeOptions]="rowsPerPageOptions"
    [nzShowSizeChanger]="true"
    [nzShowQuickJumper]="true"
    [nzScroll]="{ x: '50rem', y: 'calc(100dvh - 260px)' }"
    [nzSize]="'small'"
    (nzCurrentPageDataChange)="onRowSelect.emit($event)"
    (nzPageIndexChange)="onLazyLoad.emit($event)"
    (nzPageSizeChange)="onPageSize.emit($event)"
    [nzTotal]="total"
    [nzFrontPagination]="frontPagination"
  >
    <!-- Dynamic columns -->
    <thead>
      <tr>
        <ng-container *ngFor="let col of columns">
          <th
            [nzSortOrder]="null"
            [nzSortFn]="col.sortable ? true : false"
            *ngIf="col.sortable !== false"
            [style.width]="col.width"
          >
            {{ col.header | translate }}
          </th>
          <th *ngIf="col.sortable === false" [style.width]="col.width">
            {{ col.header | translate }}
          </th>
        </ng-container>
        <th *ngIf="actions && actions.length > 0" style="width: 120px">
          Actions
        </th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let rowData of basicTable.data; let rowIndex = index">
        <ng-container *ngFor="let col of columns">
          <td *ngIf="col.template === 'date'">
            {{ rowData[col.field] | date : "medium" }}
          </td>
          <td *ngIf="col.template === 'currency'">
            {{ rowData[col.field] | currency }}
          </td>
          <td *ngIf="col.template === 'number'">
            {{ rowData[col.field] | number }}
          </td>
          <td *ngIf="col.template === 'boolean'">
            <span
              class="status-badge"
              [class.active]="rowData[col.field]"
              [class.inactive]="!rowData[col.field]"
            >
              {{
                rowData[col.field]
                  ? ("common.active" | translate)
                  : ("common.inactive" | translate)
              }}
            </span>
          </td>
          <td *ngIf="!col.template">
            {{ rowData[col.field] }}
          </td>
        </ng-container>
        <td *ngIf="actions && actions.length > 0">
          <div class="action-buttons">
            <button
              *ngFor="let action of actions; let i = index"
              class="action-btn"
              [class]="action.severity || 'primary'"
              [hidden]="action.disabled || false"
              (click)="onActionClick.emit({ action, rowData, rowIndex })"
              [title]="action.label | translate"
            >
              <a
                class="w-full h-full"
                *ngIf="action.severity === 'danger'"
                nz-popconfirm
                nzPopconfirmTitle="Are you sure?"
                nzOkText="ok"
                nzCancelText="cancel"
                (nzOnConfirm)="confirm(rowData)"
              >
                <i nz-icon [nzType]="action.icon || ''" nzTheme="outline"></i>
              </a>
              <i
                nz-icon
                [nzType]="action.icon || ''"
                nzTheme="outline"
                *ngIf="action.severity !== 'danger'"
              ></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>

    <ng-template #nzEmpty>
      <div class="empty-state">
        <i
          nz-icon
          nzType="inbox"
          nzTheme="outline"
          style="font-size: 3rem; color: #ccc"
        ></i>
        <p>No data available</p>
      </div>
    </ng-template>
  </nz-table>
</div>
